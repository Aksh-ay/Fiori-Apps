<mvc:View controllerName="zsd_sales_week.controller.Overview"
    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:layout="sap.ui.layout"
    xmlns:table="sap.ui.table">
    <App id="idOverview">
        <pages>
            <Page id="idOverviewPage" showHeader="false" showFooter="false" class="sapUiNoContentPadding">
                <layout:DynamicSideContent id="dsc" sideContentPosition="Begin" sideContentVisibility="AlwaysShow" equalSplit="false" showSideContent="true">
                    <!-- ========== LEFT: FILTERS ========== -->
                    <layout:sideContent>
                        <VBox class="sapUiTinyMargin" fitContainer="true" renderType="Bare">
                            <Toolbar>
                                <Title text="Filters" />
                                <ToolbarSpacer />
                                <Button id="btnToggleSide" text="Hide" type="Transparent" icon="sap-icon://menu2" press=".onToggleSideContent" />
                            </Toolbar>
                            <VBox class="sapUiTinyMargin" renderType="Bare">
                                <!-- Bill Date (range) -->
                                <HBox>
                                    <Label text="Bill Date" width="8rem"/>
                                    <DatePicker value="{'path': 'oFilterModel>/BillDate',
                                                        'type': 'sap.ui.model.type.Date',
                                                        'formatOptions': {
                                                        'pattern': 'MMM dd, yyyy'}}"  width="13rem" change=".onBillDateChange" />
                                </HBox>
                                <!-- Contract No -->
                                <HBox>
                                    <Label text="Contract No" width="8rem"/>
                                    <MultiInput placeholder="Contract No..." showValueHelp="true" valueHelpRequest=".onGenericValueHelp" suggestionItems="{oTableModel>/}" width="13rem">
                                        <customData>
                                            <core:CustomData key="field" value="ContractNo"/>
                                            <core:CustomData key="label" value="Contract No"/>
                                        </customData>
                                        <suggestionItems>
                                            <core:Item key="{oTableModel>ContractNo}" text="{oTableModel>ContractNo}"/>
                                        </suggestionItems>
                                    </MultiInput>
                                </HBox>
                                <!-- Sales Order No -->
                                <HBox>
                                    <Label text="Sales Order No" width="8rem"/>
                                    <MultiInput placeholder="Sales Order No..." showValueHelp="true" valueHelpRequest=".onGenericValueHelp" suggestionItems="{oTableModel>/}" width="13rem">
                                        <customData>
                                            <core:CustomData key="field" value="SalesOrderNo"/>
                                            <core:CustomData key="label" value="Sales Order No"/>
                                        </customData>
                                        <suggestionItems>
                                            <core:Item key="{oTableModel>SalesOrderNo}" text="{oTableModel>SalesOrderNo}"/>
                                        </suggestionItems>
                                    </MultiInput>
                                </HBox>
                                <!-- Product Category -->
                                <HBox>
                                    <Label text="Product Category" width="8rem"/>
                                    <MultiInput placeholder="Product Category..." showValueHelp="true" valueHelpRequest=".onGenericValueHelp" suggestionItems="{oTableModel>/}" width="13rem">
                                        <customData>
                                            <core:CustomData key="field" value="ProductCategoryDesc"/>
                                            <core:CustomData key="label" value="Product Category"/>
                                        </customData>
                                        <suggestionItems>
                                            <core:Item key="{oTableModel>ProductCategoryDesc}" text="{oTableModel>ProductCategoryDesc}"/>
                                        </suggestionItems>
                                    </MultiInput>
                                </HBox>
                                <!-- Sold-to Party -->
                                <HBox>
                                    <Label text="Sold-to Party" width="8rem"/>
                                    <MultiInput placeholder="Sold-to Party..." showValueHelp="true" valueHelpRequest=".onGenericValueHelp" suggestionItems="{oTableModel>/}" width="13rem">
                                        <customData>
                                            <core:CustomData key="field" value="SoldToParty"/>
                                            <core:CustomData key="label" value="Sold-to Party"/>
                                        </customData>
                                        <suggestionItems>
                                            <core:Item key="{oTableModel>SoldToParty}" text="{oTableModel>SoldToParty}"/>
                                        </suggestionItems>
                                    </MultiInput>
                                </HBox>
                                <!-- Ship-to Party -->
                                <HBox>
                                    <Label text="Ship-to Party" width="8rem"/>
                                    <MultiInput placeholder="Ship-to Party..." showValueHelp="true" valueHelpRequest=".onGenericValueHelp" suggestionItems="{oTableModel>/}" width="13rem">
                                        <customData>
                                            <core:CustomData key="field" value="ShipToParty"/>
                                            <core:CustomData key="label" value="Ship-to Party"/>
                                        </customData>
                                        <suggestionItems>
                                            <core:Item key="{oTableModel>ShipToParty}" text="{oTableModel>ShipToParty}"/>
                                        </suggestionItems>
                                    </MultiInput>
                                </HBox>
                                <!-- Ship-to Party Name -->
                                <HBox>
                                    <Label text="Ship-to Party Name" width="8rem"/>
                                    <MultiInput placeholder="Sold-to Party..." showValueHelp="true" valueHelpRequest=".onGenericValueHelp" suggestionItems="{oTableModel>/}" width="13rem">
                                        <customData>
                                            <core:CustomData key="field" value="ShipToPartyName"/>
                                            <core:CustomData key="label" value="Ship-to Party Name"/>
                                        </customData>
                                        <suggestionItems>
                                            <core:Item key="{oTableModel>ShipToPartyName}" text="{oTableModel>ShipToPartyName}"/>
                                        </suggestionItems>
                                    </MultiInput>
                                </HBox>
                                <!-- USD Wt. Price -->
                                <HBox>
                                    <Label text="USD Wt. Price" width="8rem"/>
                                    <Select width="4rem" selectedKey="{oFilterModel>/QtyFilters/USDWtPrice/op}" items="{operators>/}">
                                        <items>
                                            <core:Item key="{operators>Key}" text="{operators>Text}" /> 
                                        </items>
                                    </Select>
                                    <ToolbarSpacer width="0.5rem"/>
                                    <Input  value="{path: 'oFilterModel>/QtyFilters/USDWtPrice/v1',
                                                    type: 'sap.ui.model.type.Float',
                                                    formatOptions: {
                                                        minFractionDigits: 3,
                                                        maxFractionDigits: 3,
                                                        preserveDecimals: false}}" width="4rem" placeholder="{= ${oFilterModel>/QtyFilters/USDWtPrice/op} === 'BT' ? 'From' : 'Value'}"/>
                                    <ToolbarSpacer width="0.5rem"/>
                                    <Input  value="{path: 'oFilterModel>/QtyFilters/USDWtPrice/v2',
                                                    type: 'sap.ui.model.type.Float',
                                                    formatOptions: {
                                                        minFractionDigits: 3,
                                                        maxFractionDigits: 3,
                                                        preserveDecimals: false}}" width="4rem" placeholder="To" visible="{= ${oFilterModel>/QtyFilters/USDWtPrice/op} === 'BT'}"/>
                                </HBox>
                                <!-- Sum of Quantity -->
                                <HBox>
                                    <Label text="Sum of Quantity" width="8rem"/>
                                    <Select width="4rem" selectedKey="{oFilterModel>/QtyFilters/SumOfQuantity/op}" items="{operators>/}">
                                        <items>
                                            <core:Item key="{operators>Key}" text="{operators>Text}" /> 
                                        </items>
                                    </Select>
                                    <ToolbarSpacer width="0.5rem"/>
                                    <Input  value="{path: 'oFilterModel>/QtyFilters/SumOfQuantity/v1',
                                                    type: 'sap.ui.model.type.Float',
                                                    formatOptions: {
                                                        minFractionDigits: 3,
                                                        maxFractionDigits: 3,
                                                        preserveDecimals: false}}" width="4rem" placeholder="{= ${oFilterModel>/QtyFilters/SumOfQuantity/op} === 'BT' ? 'From' : 'Value'}"/>
                                    <ToolbarSpacer width="0.5rem"/>
                                    <Input  value="{path: 'oFilterModel>/QtyFilters/SumOfQuantity/v2',
                                                    type: 'sap.ui.model.type.Float',
                                                    formatOptions: {
                                                        minFractionDigits: 3,
                                                        maxFractionDigits: 3,
                                                        preserveDecimals: false}}" width="4rem" placeholder="To" visible="{= ${oFilterModel>/QtyFilters/SumOfQuantity/op} === 'BT'}"/>
                                </HBox>
                            </VBox>
                            <!-- Buttons -->
                            <HBox class="sapUiTinyMarginTop">
                                <Button text="Apply" press=".onApplyFilters" type="Emphasized" class="sapUiTinyMarginEnd"/>
                                <Button text="Reset" press=".onResetFilters" />
                            </HBox>
                        </VBox>
                    </layout:sideContent>

                    <!-- ========== RIGHT: MAIN CONTENT ========== -->
                    <layout:mainContent>
                        <!-- Remove extra wrappers/margins so there is NO blank space -->
                        <VBox class="sapUiTinyMargin" fitContainer="true">
                            <!-- Single toolbar (no ScrollContainer; tiny bottom margin) -->
                            <OverflowToolbar id="mainToolbar" design="Auto" class="sapUiTinyMarginBottom">
                                <Button id="btnToggleMain" text="{= ${device>/system/phone} ? '' : 'Filters'}" tooltip="Filters" type="Transparent" icon="sap-icon://menu2" press=".onToggleMainContent">
                                    <layoutData>
                                        <OverflowToolbarLayoutData priority="NeverOverflow" />
                                    </layoutData>
                                </Button>
                                <ToolbarSpacer/>
                                <Button id="btnSync" text="" icon="sap-icon://synchronize" type="Transparent" press=".onSyncTable"/>
                                <Button id="btnSort" text="{= ${device>/system/phone} ? '' : 'Sort'}" tooltip="Sort" icon="sap-icon://sort" type="Transparent" press=".onOpenSortDialog">
                                    <layoutData>
                                        <OverflowToolbarLayoutData priority="NeverOverflow" />
                                    </layoutData>
                                </Button>
                                <Button id="btnHide" text="{= ${device>/system/phone} ? '' : 'Hide/Show'}" tooltip="Hide/Show" icon="sap-icon://action-settings" type="Transparent" press=".onOpenColumnSettings">
                                    <layoutData>
                                        <OverflowToolbarLayoutData priority="NeverOverflow" />
                                    </layoutData>
                                </Button>
                                <Button id="btnExport" text="{= ${device>/system/phone} ? '' : 'Export to Excel'}" tooltip="Export to Excel" icon="sap-icon://excel-attachment" type="Transparent" press=".onExportExcel">
                                    <layoutData>
                                        <OverflowToolbarLayoutData priority="NeverOverflow" />
                                    </layoutData>
                                </Button>
                            </OverflowToolbar>
                            <OverflowToolbar id="headerToolbar" design="Auto">
                                <HBox>
                                    <Title text="By Days/Weeks"/>
                                    <Text text="By Bill date" class="sapUiSmallMarginBegin" visible="{= ${device>/system/phone} ? false : true}"/>
                                </HBox>
                                <ToolbarSpacer/>
                                <Text text="TOC Date- Thrusday to Wednesday" visible="{= ${device>/system/phone} ? false : true}"/>
                                <ToolbarSpacer/>
                                <HBox>
                                    <Title text="{path: 'oFilterModel>/WeekStartDate', formatter: '.formatDate'}"/>
                                    <Title text="-" class="sapUiTinyMarginBeginEnd"/>
                                    <Title text="{path: 'oFilterModel>/WeekEndDate', formatter: '.formatDate'}"/>
                                </HBox>
                            </OverflowToolbar>
                            <ScrollContainer id="tblScroll" horizontal="true" vertical="true" height="80%" focusable="true">
                                <Table id="idWeeklySalesTable" inset="false" width="100%" sticky="ColumnHeaders" items="{oTableModel>/}">
                                    <columns>
                                        <Column width="6rem"><Text text="Year"/></Column>
                                        <Column width="6rem"><Text text="Month"/></Column>
                                        <Column width="6rem"><Text text="Bill Date"/></Column>
                                        <Column width="6rem"><Text text="Contract No"/></Column>
                                        <Column width="6rem"><Text text="Sales Order No"/></Column>
                                        <Column width="6rem"><Text text="Product Category"/></Column>
                                        <Column width="6rem"><Text text="Sold to Party"/></Column>
                                        <Column width="12rem"><Text text="Ship to Party"/></Column>
                                        <Column width="10rem"><Text text="Ship to Party Name"/></Column>
                                        <Column width="10rem"><Text text="USD_Wt_Price"/></Column>
                                        <Column width="10rem"><Text text="Sum of Quantity"/></Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem vAlign="Middle">
                                            <cells>
                                                <Text text="{oTableModel>BillingYear}" />
                                                <Text text="{oTableModel>BillingMonth}" />
                                                <Text text="{path: 'oTableModel>BillDate', formatter: '.formatDate'}" />
                                                <Text text="{oTableModel>ContractNo}" />
                                                <Text text="{oTableModel>SalesOrderNo}" />
                                                <Text text="{oTableModel>ProductCategoryDesc}" />
                                                <Text text="{oTableModel>SoldToParty}" />
                                                <Text text="{oTableModel>ShipToParty}" />
                                                <Text text="{oTableModel>ShipToPartyName}" />
                                                <Text text="{path:'oTableModel>USDWtPrice', formatter: '.formatShortCurrency'}" tooltip="{ path: 'oTableModel>USDWtPrice', formatter: '.formatFullCurrency'}"/>
                                                <Text text="{ path:'oTableModel>SumOfQuantity', formatter: '.formatShortNumber' }" tooltip="{ path: 'oTableModel>SumOfQuantity', formatter: '.formatFullNumber'}"/>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </ScrollContainer>
                        </VBox>
                    </layout:mainContent>
                </layout:DynamicSideContent>
            </Page>
        </pages>
    </App>    
</mvc:View>